type: object
description: >
  Sync progress summary of the *subject* provider.
properties:
  legacy:
    type: boolean
    description: |
      Denotes that the *subject* provider is in legacy version and does not
      recognize the sync progress model. Such provider does not report its progress
      and will have default entries in the registry (seq = 1) until it is upgraded.
      Such provider cannot be marked as active (is always perceived as joining).
  joining:
    type: boolean
    description: |
      Indicates that the *subject* provider is not yet actively supporting the space,
      but catching up with changes from peer providers. It is set to `false`
      when all the changes have been synchronized. After that, this flag
      remains unchanged during the support lifecycle (the `desync` flag
      is used to indicate temporary desynchronization).
  archival:
    type: boolean
    description: |
      Denotes that the *subject* provider does not support the space anymore and
      the stored values are archival. Such entries are kept until all peer providers
      have seen the latest seq of the retired provider - and then removed in the
      process of pruning the registry.
  desync:
    type: boolean
    description: |
      Indicates desynchronization state - when the seq synchronization delay
      between the *subject* provider and another exceeds a certain threshold.
      The provider marked with desync should be perceived as having a
      considerably outdated view on current changes in the space.
  lastReport:
    type: integer
    description: |
      Timestamp in seconds (UNIX epoch) of the last sync progress report
      submitted by the *subject* provider.
  perPeer:
    type: object
    description: |
      Sync progress of the *subject* provider with peer providers. Expresses the
      knowledge of *subject* provider about latest dbsync sequence numbers
      generated by peer providers.

      Sync progress stats are represented by a map of provider Ids supporting this
      space and corresponding information about last seen sequence and its timestamp.

      Includes entry for *subject* provider (self), which denotes the current newest
      sequence number emmitted by *subject* provider and its timestamp.
    properties:
      additionalProperties:
        $ref: '#/definitions/SyncProgressPeerSummary'

required:
  - legacy
  - joining
  - archival
  - desync
  - lastReport
  - perPeer

example:
  legacy: false
  joining: false
  archival: false
  desync: true
  lastReport: 1571147511
  perPeer:
    296ebe3c20e9666dc489b647f8647f12:
      seenSeq: 1450
      seqTimestamp: 1571147494
      diff: 0
      delay: 0
      desync: false
    dcf12429647c204896eebe3b6f686967:
      seenSeq: 46731
      seqTimestamp: 1563818960
      diff: 3139
      delay: 369
      desync: true
